@page "/"
@using System.Security.Principal
@inject User user

<PageTitle>Kontrol</PageTitle>

<AuthorizeView>
    <Authorized>
        <section>
            Hello @name

            <form action="/user/logout" method="post">
                <input type="hidden" name="redirectto" value="/">
                <input type="submit" value="logout">
            </form>
        </section>
    </Authorized>
    <NotAuthorized>
        <section>
            <h1>login</h1>
            <form action="/user/login" method="post">
                <input type="text" name="username" placeholder="username">
                <input type="password" name="password" placeholder="password">
                <input type="hidden" name="redirectto" value="/">
                <input type="submit" value="login">
            </form>
        </section>
    </NotAuthorized>
</AuthorizeView>

@code {
    string? name = null;

    protected override async Task OnParametersSetAsync()
    {
        await base.OnParametersSetAsync();
        name = await user.GetName();
    }
}